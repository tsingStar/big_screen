function setFormdata(t){var e=$.extend({},{id:0,defaultnum:3,showleftnum:2,title:"",started_at:"",ended_at:"",themeid:0},t);initThemesSelect(e.themeid),$("input[name=title]").val(e.title),$("input[name=defaultnum]").val(e.defaultnum),$("input[name=started_at]").val(e.started_at),$("input[name=ended_at]").val(e.ended_at),$("input[name=id]").val(e.id),1==e.showleftnum&&$("input[name=showleftnum]").attr("checked",!0)}function initThemesSelect(n){$("select[name=themeid]").html(""),$.each(THEMES,function(t,e){var a="";n==t&&(a="selected"),$('<option value="'+t+'" '+a+">"+e.themename+"</option>").appendTo("select[name=themeid]")})}function ajax_act_get_config(t){return $.ajax({url:"/Modules/module.php?m=choujiang&c=admin&a=ajax_act_get_config",data:{id:t},type:"get",dataType:"json"})}function ajax_act_save_config(t){return $.ajax({url:"/Modules/module.php?m=choujiang&c=admin&a=ajax_act_save_config",data:{title:t.title,defaultnum:t.defaultnum,themeid:t.themeid,started_at:t.started_at,ended_at:t.ended_at,id:t.id?t.id:0,showleftnum:t.showleftnum?t.showleftnum:2},type:"post",dataType:"json"})}function ajax_act_reset_config(t){return $.ajax({url:"/Modules/module.php?m=choujiang&c=admin&a=ajax_act_reset_config",data:{id:t},type:"get",dataType:"json"})}function ajax_act_delete_config(t){return $.ajax({url:"/Modules/module.php?m=choujiang&c=admin&a=ajax_act_delete_config",data:{id:t},type:"get",dataType:"json"})}$(document).ready(function(){$(".btn_add").on("click",function(){setFormdata(null),$("#configmodal").modal("show")}),$(".btn_edit").on("click",function(){ajax_act_get_config($(this).attr("data")).done(function(t){0<t.code?(setFormdata(t.data),$("#configmodal").modal("show")):alert(t.message)}).fail(function(){alert("请检查网络是否正常")})}),$(".btn_prize").on("click",function(){var t=$(this).attr("data");window.location.href="/Modules/module.php?m=prize&c=admin&a=index&plugname=choujiang&activityid="+t}),$(".btn_designated").on("click",function(){var t=$(this).attr("data"),e=$(this).attr("data-title");window.location.href="/Modules/module.php?m=prize&c=admin&a=designatedlist&plugname=choujiang&activityid="+t+"&title="+e}),$(".btn_records").on("click",function(){var t=$(this).attr("data");window.location.href="/Modules/module.php?m=prize&c=admin&a=zjlist&plugname=choujiang&activityid="+t}),$(".btn_reset").on("click",function(){if(!confirm("确定要清空数据吗？"))return!1;ajax_act_reset_config($(this).attr("data")).done(function(t){alert(t.message),0<t.code&&window.location.reload()}).fail(function(){alert("请检查网络是否正常")})}),$(".btn_delete").on("click",function(){if(!confirm("确定要删除吗？"))return!1;ajax_act_delete_config($(this).attr("data")).done(function(t){alert(t.message),0<t.code&&window.location.reload()}).fail(function(){alert("请检查网络是否正常")})}),$(".start").datetimepicker({format:"YYYY-MM-DD HH:mm:ss"}),$(".end").datetimepicker({format:"YYYY-MM-DD HH:mm:ss"}),$(".btn_save").on("click",function(){var t={};return t.title=$("input[name=title]").val(),""==t.title?(alert("标题必须填写，建议4个字以内"),!1):(t.defaultnum=$("input[name=defaultnum]").val(),t.defaultnum<=0?(alert("默认游戏次数必须是大于0的整数"),!1):(t.themeid=$("select[name=themeid]").val(),t.themeid<=0?(alert("必须选择一个主题"),!1):(t.started_at=$("input[name=started_at]").val(),t.ended_at=$("input[name=ended_at]").val(),""==t.started_at||""==t.ended_at?(alert("起止时间必须都填写上"),!1):(t.showleftnum=$("input[name=showleftnum]:checked").val(),t.showleftnum=t.showleftnum?1:2,t.id=$("input[name=id]").val(),void ajax_act_save_config(t).done(function(t){alert(t.message),0<t.code&&window.location.reload()}).fail(function(){alert("请检查网络是否正常")})))))})});