var camera,scene,renderer,controls;window.WBActivity.resize=function(){},window.WBActivity.start=function(){$("#wallCont").show()};var runninganimate,oss=[],targets=null,style="table",animate_start=0;function init(){oss=[],targets={table:[],sphere:[],grid:[]},(camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,1e5)).position.z=2800,scene=new THREE.Scene;for(var e=0;e<table.length;e++){var t=document.createElement("div");t.className="element";var n=document.createElement("img");n.src=table[e].src,n.setAttribute("bowtie",""),n.setAttribute("company",""),n.setAttribute("name",table[e].nickname),n.setAttribute("text",""),n.setAttribute("imgId",""),t.appendChild(n),(s=new THREE.CSS3DObject(t)).position.x=4e3*Math.random()-2e3,s.position.y=4e3*Math.random()-2e3,s.position.z=4e3*Math.random()-2e3,scene.add(s),oss.push(s)}for(var i=new THREE.Vector3,o=(e=0,table.length);e<o;e++){if(0==e)var r=1.025*Math.acos(2*e/o-1),a=Math.sqrt(o*Math.PI)*r*1.01;else r=Math.acos(2*e/o-1),a=Math.sqrt(o*Math.PI)*r;(s=new THREE.Object3D).position.x=750*Math.cos(a)*Math.sin(r),s.position.y=750*Math.sin(a)*Math.sin(r),s.position.z=750*Math.cos(r),i.copy(s.position).multiplyScalar(2),s.lookAt(i),targets.sphere.push(s)}for(i=new THREE.Vector3,e=0,o=table.length;e<o;e++){var s;(s=new THREE.Object3D).position.x=e%5*600-1200,s.position.y=-Math.floor(e/5)%5*400+800,s.position.z=200-60*e*1.5,s.rotation.z=.03*-e,i.x=s.position.x,i.y=s.position.y,i.z=s.position.z,s.lookAt(i),targets.grid.push(s)}(renderer=new THREE.CSS3DRenderer).setSize(window.innerWidth,window.innerHeight),renderer.domElement.style.position="absolute",renderer.domElement.className="lottery_renderer",document.getElementById("container").appendChild(renderer.domElement),window.addEventListener("resize",onWindowResize,!1)}function transform(e,t,n,i){TWEEN.removeAll(),scene_init();for(var o=animate_start=0;o<oss.length;o++){var r=oss[o],a=e[o];new TWEEN.Tween(r.position).to({x:a.position.x,y:a.position.y,z:a.position.z},t).easing(TWEEN.Easing.Exponential.InOut).start(),"grid"==n&&new TWEEN.Tween(r.position).to({x:a.position.x,y:a.position.y,z:a.position.z},1e3).delay(195e3).start(),new TWEEN.Tween(r.rotation).to({x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},Math.random()*t+t).easing(TWEEN.Easing.Exponential.InOut).start()}new TWEEN.Tween(this).to({},1e6).onUpdate(function(){render(n)}).start()}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight),render()}function animate(){runninganimate=window.requestAnimationFrame(animate),TWEEN.update(),render()}function resetanimate(){window.cancelAnimationFrame(runninganimate)}function scene_init(){scene.position.x=0,scene.position.y=0,scene.position.z=0,scene.rotation.x=0,scene.rotation.y=0,scene.rotation.z=0}function update2(){for(var e=0;e<oss.length;e++){var t=oss[e];t.position.z+=180,800<t.position.z&&(t.position.z=200-60*(oss.length-1)*1.5)}}function render(e){"grid"==e&&update2(),"sphere"==e&&((animate_start+=1)%1200<600?scene.rotation.y+=.1:scene.rotation.x+=.1);renderer.render(scene,camera)}function restartanimate(){TWEEN.removeAll(),resetanimate(),$(".lottery_renderer").remove()}