!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(h){function u(t,i){this.$element=h(t),this.$element.find(".btn").on("click",function(t){t.preventDefault()}),this.options=h.extend({},h.fn.spinbox.defaults,i),this.options.step=this.$element.data("step")||this.options.step,this.options.value<this.options.min?this.options.value=this.options.min:this.options.max<this.options.value&&(this.options.value=this.options.max),this.$input=this.$element.find(".spinbox-input"),this.$input.on("focusout.fu.spinbox",this.$input,h.proxy(this.change,this)),this.$element.on("keydown.fu.spinbox",this.$input,h.proxy(this.keydown,this)),this.$element.on("keyup.fu.spinbox",this.$input,h.proxy(this.keyup,this)),this.bindMousewheelListeners(),this.mousewheelTimeout={},this.options.hold?(this.$element.on("mousedown.fu.spinbox",".spinbox-up",h.proxy(function(){this.startSpin(!0)},this)),this.$element.on("mouseup.fu.spinbox",".spinbox-up, .spinbox-down",h.proxy(this.stopSpin,this)),this.$element.on("mouseout.fu.spinbox",".spinbox-up, .spinbox-down",h.proxy(this.stopSpin,this)),this.$element.on("mousedown.fu.spinbox",".spinbox-down",h.proxy(function(){this.startSpin(!1)},this))):(this.$element.on("click.fu.spinbox",".spinbox-up",h.proxy(function(){this.step(!0)},this)),this.$element.on("click.fu.spinbox",".spinbox-down",h.proxy(function(){this.step(!1)},this))),this.switches={count:1,enabled:!0},"medium"===this.options.speed?this.switches.speed=300:"fast"===this.options.speed?this.switches.speed=100:this.switches.speed=500,this.options.defaultUnit=n(this.options.defaultUnit,this.options.units)?this.options.defaultUnit:"",this.unit=this.options.defaultUnit,this.lastValue=this.options.value,this.render(),this.options.disabled&&this.disable()}function e(t){return isNaN(parseFloat(t))||(t>this.options.max?t=this.options.cycle?this.options.min:this.options.max:t<this.options.min&&(t=this.options.cycle?this.options.max:this.options.min),this.options.limitToStep&&this.options.step&&((t=function(t,i){return Math.round(t/i)*i}(t,this.options.step))>this.options.max?t-=this.options.step:t<this.options.min&&(t+=this.options.step))),t}var t=h.fn.spinbox,n=function(t,i){var s=!1,e=t.toLowerCase();return h.each(i,function(t,i){return i=i.toLowerCase(),e===i?!(s=!0):void 0}),s};u.prototype={constructor:u,destroy:function(){return this.$element.remove(),this.$element.find("input").each(function(){h(this).attr("value",h(this).val())}),this.$element[0].outerHTML},render:function(){this.setValue(this.getDisplayValue())},change:function(){this.setValue(this.getDisplayValue()),this.triggerChangedEvent()},stopSpin:function(){void 0!==this.switches.timeout&&(clearTimeout(this.switches.timeout),this.switches.count=1,this.triggerChangedEvent())},triggerChangedEvent:function(){var t=this.getValue();t!==this.lastValue&&(this.lastValue=t,this.$element.trigger("changed.fu.spinbox",t))},startSpin:function(t){if(!this.options.disabled){var i=this.switches.count;i=1===i?(this.step(t),1):i<3?1.5:i<8?2.5:4,this.switches.timeout=setTimeout(h.proxy(function(){this.iterate(t)},this),this.switches.speed/i),this.switches.count++}},iterate:function(t){this.step(t),this.startSpin(t)},step:function(t){var i;this.setValue(this.getDisplayValue()),i=(i=t?this.options.value+this.options.step:this.options.value-this.options.step).toFixed(5),this.setValue(i+this.unit)},getDisplayValue:function(){var t=this.parseInput(this.$input.val());return t||this.options.value},setDisplayValue:function(t){this.$input.val(t)},getValue:function(){var t=this.options.value;return"."!==this.options.decimalMark&&(t=(t+"").split(".").join(this.options.decimalMark)),t+this.unit},setValue:function(t){if("."!==this.options.decimalMark&&(t=this.parseInput(t)),"number"!=typeof t){var i=t.replace(/[0-9.-]/g,"");this.unit=n(i,this.options.units)?i:this.options.defaultUnit}var s=this.getIntValue(t);return isNaN(s)&&!isFinite(s)?this.setValue(this.options.value):(s=e.call(this,s),t=(this.options.value=s)+this.unit,"."!==this.options.decimalMark&&(t=(t+"").split(".").join(this.options.decimalMark)),this.setDisplayValue(t),this)},value:function(t){return t||0===t?this.setValue(t):this.getValue()},parseInput:function(t){return(t+"").split(this.options.decimalMark).join(".")},getIntValue:function(t){return void 0!==(t=void 0===t?this.getValue():t)?("string"==typeof t&&(t=this.parseInput(t)),t=parseFloat(t,10)):void 0},disable:function(){this.options.disabled=!0,this.$element.addClass("disabled"),this.$input.attr("disabled",""),this.$element.find("button").addClass("disabled")},enable:function(){this.options.disabled=!1,this.$element.removeClass("disabled"),this.$input.removeAttr("disabled"),this.$element.find("button").removeClass("disabled")},keydown:function(t){var i=t.keyCode;38===i?this.step(!0):40===i?this.step(!1):13===i&&this.change()},keyup:function(t){var i=t.keyCode;38!==i&&40!==i||this.triggerChangedEvent()},bindMousewheelListeners:function(){var t=this.$input.get(0);t.addEventListener?(t.addEventListener("mousewheel",h.proxy(this.mousewheelHandler,this),!1),t.addEventListener("DOMMouseScroll",h.proxy(this.mousewheelHandler,this),!1)):t.attachEvent("onmousewheel",h.proxy(this.mousewheelHandler,this))},mousewheelHandler:function(t){if(!this.options.disabled){var i=window.event||t,s=Math.max(-1,Math.min(1,i.wheelDelta||-i.detail)),e=this;return clearTimeout(this.mousewheelTimeout),this.mousewheelTimeout=setTimeout(function(){e.triggerChangedEvent()},300),s<0?this.step(!0):this.step(!1),i.preventDefault?i.preventDefault():i.returnValue=!1,!1}}},h.fn.spinbox=function(e){var n,o=Array.prototype.slice.call(arguments,1),t=this.each(function(){var t=h(this),i=t.data("fu.spinbox"),s="object"==typeof e&&e;i||t.data("fu.spinbox",i=new u(this,s)),"string"==typeof e&&(n=i[e].apply(i,o))});return void 0===n?t:n},h.fn.spinbox.defaults={value:0,min:0,max:999,step:1,hold:!0,speed:"medium",disabled:!1,cycle:!1,units:[],decimalMark:".",defaultUnit:"",limitToStep:!1},h.fn.spinbox.Constructor=u,h.fn.spinbox.noConflict=function(){return h.fn.spinbox=t,this},h(document).on("mousedown.fu.spinbox.data-api","[data-initialize=spinbox]",function(t){var i=h(t.target).closest(".spinbox");i.data("fu.spinbox")||i.spinbox(i.data())}),h(function(){h("[data-initialize=spinbox]").each(function(){var t=h(this);t.data("fu.spinbox")||t.spinbox(t.data())})})});