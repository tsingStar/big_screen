"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="monospaced.elastic"),angular.module("monospaced.elastic",[]).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(I,E,$){"use strict";return{require:"ngModel",restrict:"A, C",link:function(i,e,t,o){function a(){var t=c;b=getComputedStyle(p=l),angular.forEach(z,function(e){t+=e+":"+b.getPropertyValue(e)+";"}),m.setAttribute("style",t)}function r(){var e,t,o,r,n;p!==l&&a(),u||(u=!0,m.value=l.value+g,m.style.overflowY=l.style.overflowY,e=""===l.style.height?"auto":parseInt(l.style.height,10),"px"===(t=getComputedStyle(l).getPropertyValue("width")).substr(t.length-2,2)&&(r=parseInt(t,10)-w.width,m.style.width=r+"px"),o=m.scrollHeight,P<o?(o=P,n="scroll"):o<V&&(o=V),o+=w.height,l.style.overflowY=n||"hidden",e!==o&&(i.$emit("elastic:resize",d,e,o),l.style.height=o+"px"),I(function(){u=!1},1,!1))}function n(){u=!1,r()}var l=e[0],d=e;if("TEXTAREA"===l.nodeName&&E.getComputedStyle){d.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var s=l.value;l.value="",l.value=s;var p,u,g=t.msdElastic?t.msdElastic.replace(/\\n/g,"\n"):$.append,h=angular.element(E),c="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",y=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+c+'"/>').data("elastic",!0),m=y[0],b=getComputedStyle(l),f=b.getPropertyValue("resize"),w="border-box"===b.getPropertyValue("box-sizing")||"border-box"===b.getPropertyValue("-moz-box-sizing")||"border-box"===b.getPropertyValue("-webkit-box-sizing")?{width:parseInt(b.getPropertyValue("border-right-width"),10)+parseInt(b.getPropertyValue("padding-right"),10)+parseInt(b.getPropertyValue("padding-left"),10)+parseInt(b.getPropertyValue("border-left-width"),10),height:parseInt(b.getPropertyValue("border-top-width"),10)+parseInt(b.getPropertyValue("padding-top"),10)+parseInt(b.getPropertyValue("padding-bottom"),10)+parseInt(b.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},x=parseInt(b.getPropertyValue("min-height"),10),v=parseInt(b.getPropertyValue("height"),10),V=Math.max(x,v)-w.height,P=parseInt(b.getPropertyValue("max-height"),10),z=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];d.data("elastic")||(P=P&&0<P?P:9e4,m.parentNode!==document.body&&angular.element(document.body).append(m),d.css({resize:"none"===f||"vertical"===f?"none":"horizontal"}).data("elastic",!0),l.oninput="onpropertychange"in l&&"oninput"in l?l.onkeyup=r:r,h.bind("resize",n),i.$watch(function(){return o.$modelValue},function(e){n()}),i.$on("elastic:adjust",function(){a(),n()}),I(r,0,!1),i.$on("$destroy",function(){y.remove(),h.unbind("resize",n)}))}}}}]);