angular.module("angular-flot",[]).directive("flot",["$timeout",function(u){return{restrict:"EA",template:"<div></div>",scope:{dataset:"=",options:"=",callback:"=",onPlotClick:"&",onPlotHover:"&",onPlotSelected:"&"},link:function(n,t,o){var e=null,i=o.width||"100%",c=o.height||"100%";if(((n.options||{}).legend||{}).container instanceof jQuery)throw new Error('Please use a jQuery expression string with the "legend.container" option.');n.dataset||(n.dataset=[]),n.options||(n.options={legend:{show:!1}});var l=$(t.children()[0]);l.css({width:i,height:c});function s(){var t=$.plot(l,n.dataset,n.options);return n.callback&&n.callback(t),t}l.on("plotclick",function(t,o,e){u(function(){n.onPlotClick({event:t,pos:o,item:e})})}),l.on("plotselected",function(t,o){u(function(){n.onPlotSelected({event:t,ranges:o})})}),l.on("plothover",function(t,o,e){u(function(){n.onPlotHover({event:t,pos:o,item:e})})});var a=n.$watch("options",function(){e=s()},!0),r=n.$watch("dataset",function(t){return e?(e.setData(t),e.setupGrid(),e.draw()):void(e=s())},!0);o.$observe("width",function(t){t&&(i=t,l.css("width",t))}),o.$observe("height",function(t){t&&(c=t,l.css("height",t))}),t.on("$destroy",function(){l.off("plotclick"),l.off("plothover"),l.off("plotselected"),e.shutdown(),r(),a()})}}}]);