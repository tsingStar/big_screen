!function(c,D,q,j){"use strict";var k=D.module("ngDragDrop",[]).service("ngDragDropService",["$timeout","$parse","$q",function(x,g,m){this.draggableScope=null,this.droppableScope=null,q("head").prepend('<style type="text/css">@charset "UTF-8";.angular-dragdrop-hide{display: none !important;}</style>'),this.callEventCallback=function(a,e,t,n){if(e){var i=(s=-1!==(d=e).indexOf("(")?d.indexOf("("):d.length,p=-1!==d.lastIndexOf(")")?d.lastIndexOf(")"):d.length,c=d.substring(s+1,p),u=-1!==d.indexOf(".")?d.substr(0,d.indexOf(".")):null,u=a[u]&&"function"==typeof a[u].constructor?u:null,{callback:d.substring(u&&u.length+1||0,s),args:q.map(c&&c.split(",")||[],function(e){return[g(e)(a)]}),constructor:u}),r=i.callback,l=i.constructor,o=[t,n].concat(i.args);return(a[r]||a[l][r]).apply(a[r]?a:a[l],o)}var d,s,p,c,u},this.invokeDrop=function(a,t,n,i){var r,l,o,d,s,p,c={},u={},g={},f={},b=null,h=this.droppableScope,v=this.draggableScope,y=null,e=[];d=a.ngattr("ng-model"),s=t.ngattr("ng-model"),r=v.$eval(d),l=h.$eval(s),b=t.find("[jqyoui-draggable]:last,[data-jqyoui-draggable]:last"),u=h.$eval(t.attr("jqyoui-droppable")||t.attr("data-jqyoui-droppable"))||[],(c=v.$eval(a.attr("jqyoui-draggable")||a.attr("data-jqyoui-draggable"))||[]).index=this.fixIndex(v,c,r),u.index=this.fixIndex(h,u,l),p=D.isArray(r)?c.index:null,g=D.isArray(r)?r[p]:r,c.deepCopy&&(g=D.copy(g)),f=D.isArray(l)&&u&&u.index!==j?l[u.index]:D.isArray(l)?{}:l,u.deepCopy&&(f=D.copy(f)),c.beforeDrop&&e.push(this.callEventCallback(v,c.beforeDrop,n,i)),m.all(e).then(D.bind(this,function(){if(c.insertInline&&d===s){if(c.index>u.index){o=r[c.index];for(var e=c.index;e>u.index;e--)l[e]=D.copy(l[e-1]),l[e-1]={},l[e][c.direction]="left";l[u.index]=o}else{o=r[c.index];for(e=c.index;e<u.index;e++)l[e]=D.copy(l[e+1]),l[e+1]={},l[e][c.direction]="right";l[u.index]=o}this.callEventCallback(h,u.onDrop,n,i)}else!0===c.animate?((y=a.clone()).css({position:"absolute"}).css(a.offset()),q("body").append(y),a.addClass("angular-dragdrop-hide"),this.move(y,0<b.length?b:t,null,"fast",u,function(){y.remove()}),this.move(0<b.length&&!u.multiple?b:[],a.parent("[jqyoui-droppable],[data-jqyoui-droppable]"),k.startXY,"fast",u,D.bind(this,function(){x(D.bind(this,function(){a.css({position:"relative",left:"",top:""}).removeClass("angular-dragdrop-hide"),b.css({position:"relative",left:"",top:"",display:"none"===b.css("display")?"":b.css("display")}),this.mutateDraggable(v,u,c,d,s,f,a),this.mutateDroppable(h,u,c,s,g,p),this.callEventCallback(h,u.onDrop,n,i)}))}))):x(D.bind(this,function(){this.mutateDraggable(v,u,c,d,s,f,a),this.mutateDroppable(h,u,c,s,g,p),this.callEventCallback(h,u.onDrop,n,i)}))})).finally(D.bind(this,function(){this.restore(a)}))},this.move=function(e,a,t,n,i,r){if(0===e.length)return r&&c.setTimeout(function(){r()},300),!1;var l=e.css("z-index"),o=e[i.containment||"offset"](),d=a.css("display"),s=a.hasClass("ng-hide"),p=a.hasClass("angular-dragdrop-hide");null===t&&0<a.length&&((a.attr("jqyoui-draggable")||a.attr("data-jqyoui-draggable"))!==j&&a.ngattr("ng-model")!==j&&a.is(":visible")&&i&&i.multiple?(t=a[i.containment||"offset"](),!1===i.stack?t.left+=a.outerWidth(!0):t.top+=a.outerHeight(!0)):(s&&a.removeClass("ng-hide"),p&&a.removeClass("angular-dragdrop-hide"),t=a.css({visibility:"hidden",display:"block"})[i.containment||"offset"](),a.css({visibility:"",display:d}))),e.css({position:"absolute","z-index":9999}).css(o).animate(t,n,function(){s&&a.addClass("ng-hide"),p&&a.addClass("angular-dragdrop-hide"),e.css("z-index",l),r&&r()})},this.mutateDroppable=function(e,a,t,n,i,r){var l=e.$eval(n);e.dndDragItem=i,D.isArray(l)?(a&&0<=a.index?l[a.index]=i:l.push(i),t&&!0===t.placeholder&&(l[l.length-1].jqyoui_pos=r)):(g(n+" = dndDragItem")(e),t&&!0===t.placeholder&&(l.jqyoui_pos=r))},this.mutateDraggable=function(e,a,t,n,i,r,l){var o=D.equals(r,{})||!r,d=e.$eval(n);e.dndDropItem=r,t&&t.placeholder?"keep"!=t.placeholder&&(D.isArray(d)&&t.index!==j?d[t.index]=r:g(n+" = dndDropItem")(e)):D.isArray(d)?o?t&&!0!==t.placeholder&&"keep"!==t.placeholder&&d.splice(t.index,1):d[t.index]=r:(g(n+" = dndDropItem")(e),e.$parent&&g(n+" = dndDropItem")(e.$parent)),this.restore(l)},this.restore=function(e){e.css({"z-index":"",left:"",top:""})},this.fixIndex=function(e,a,t){if(a.applyFilter&&D.isArray(t)&&0<t.length){var n=e[a.applyFilter]()[a.index],i=j;return t.forEach(function(e,a){D.equals(e,n)&&(i=a)}),i}return a.index}}]).directive("jqyouiDraggable",["ngDragDropService",function(s){return{require:"?jqyouiDroppable",restrict:"A",link:function(t,e,n){function a(e,a){e?(i=t.$eval(d.attr("jqyoui-draggable")||d.attr("data-jqyoui-draggable"))||{},r=t.$eval(n.jqyouiOptions)||{},d.draggable({disabled:!1}).draggable(r).draggable({start:function(e,a){s.draggableScope=t,l=q(r.helper?a.helper:this).css("z-index"),q(r.helper?a.helper:this).css("z-index",9999),k.startXY=q(this)[i.containment||"offset"](),s.callEventCallback(t,i.onStart,e,a)},stop:function(e,a){q(r.helper?a.helper:this).css("z-index",l),s.callEventCallback(t,i.onStop,e,a)},drag:function(e,a){s.callEventCallback(t,i.onDrag,e,a)}})):d.draggable({disabled:!0}),o&&D.isDefined(e)&&(D.equals(n.drag,"true")||D.equals(n.drag,"false"))&&(o(),o=null)}var i,r,l,o,d=q(e);o=t.$watch(function(){return t.$eval(n.drag)},a),a(),d.on("$destroy",function(){d.draggable({disabled:!0}).draggable("destroy")})}}}]).directive("jqyouiDroppable",["ngDragDropService","$q",function(d,s){return{restrict:"A",priority:1,link:function(n,e,i){function a(e,a){e?(r=n.$eval(q(o).attr("jqyoui-droppable")||q(o).attr("data-jqyoui-droppable"))||{},l=n.$eval(i.jqyouiOptions)||{},o.droppable({disabled:!1}).droppable(l).droppable({over:function(e,a){d.callEventCallback(n,r.onOver,e,a)},out:function(e,a){d.callEventCallback(n,r.onOut,e,a)},drop:function(e,a){var t;(r.beforeDrop?d.callEventCallback(n,r.beforeDrop,e,a):((t=s.defer()).resolve(),t.promise)).then(D.bind(this,function(){q(a.draggable).ngattr("ng-model")&&i.ngModel?(d.droppableScope=n,d.invokeDrop(q(a.draggable),q(this),e,a)):d.callEventCallback(n,r.onDrop,e,a)}),function(){a.draggable.animate({left:"",top:""},l.revertDuration||0)})}})):o.droppable({disabled:!0}),t&&D.isDefined(e)&&(D.equals(i.drop,"true")||D.equals(i.drop,"false"))&&(t(),t=null)}var r,l,t,o=q(e);t=n.$watch(function(){return n.$eval(i.drop)},a),a(),o.on("$destroy",function(){o.droppable({disabled:!0}).droppable("destroy")})}}}]);q.fn.ngattr=function(e,a){var t=this[0];return t.getAttribute(e)||t.getAttribute("data-"+e)}}(window,window.angular,window.jQuery);