function wizardButtonDirective(i){angular.module("mgo-angular-wizard").directive(i,function(){return{restrict:"A",replace:!1,require:"^wizard",link:function(t,e,n,r){e.on("click",function(e){e.preventDefault(),t.$apply(function(){t.$eval(n[i]),r[i.replace("wz","").toLowerCase()]()})})}}})}angular.module("templates-angularwizard",["step.html","wizard.html"]),angular.module("step.html",[]).run(["$templateCache",function(e){e.put("step.html",'<section ng-show="selected" ng-class="{current: selected, done: completed}" class="step" ng-transclude>\n</section>')}]),angular.module("wizard.html",[]).run(["$templateCache",function(e){e.put("wizard.html",'<div>\n    <div class="steps" ng-transclude></div>\n    <ul class="steps-indicator steps-{{getEnabledSteps().length}}" ng-if="!hideIndicators">\n      <li ng-class="{default: !step.completed && !step.selected, current: step.selected && !step.completed, done: step.completed && !step.selected, editing: step.selected && step.completed}" ng-repeat="step in getEnabledSteps()">\n        <a ng-click="goTo(step)">{{step.title || step.wzTitle}}</a>\n      </li>\n    </ul>\n</div>\n')}]),angular.module("mgo-angular-wizard",["templates-angularwizard"]),angular.module("mgo-angular-wizard").directive("wzStep",function(){return{restrict:"EA",replace:!0,transclude:!0,scope:{wzTitle:"@",canenter:"=",canexit:"=",disabled:"@?wzDisabled",description:"@",wzData:"="},require:"^wizard",templateUrl:function(e,t){return t.template||"step.html"},link:function(e,t,n,r){e.title=e.wzTitle,r.addStep(e)}}}),angular.module("mgo-angular-wizard").directive("wizard",function(){return{restrict:"EA",replace:!0,transclude:!0,scope:{currentStep:"=",onFinish:"&",hideIndicators:"=",editMode:"=",name:"@"},templateUrl:function(e,t){return t.template||"wizard.html"},controller:["$scope","$element","$log","WizardHandler","$q",function(i,e,t,n,a){function r(){angular.forEach(i.getEnabledSteps(),function(e){e.selected=!1}),i.selectedStep=null}var l=!0;n.addWizard(i.name||n.defaultName,this),i.$on("$destroy",function(){n.removeWizard(i.name||n.defaultName)}),i.steps=[];function c(t){var n=0,r=-1;return angular.forEach(i.getEnabledSteps(),function(e){e===t&&(r=n),n++}),r}function u(t){var n=null;return angular.forEach(i.getEnabledSteps(),function(e){e.wzTitle===t&&(n=e)}),n}i.context={},i.$watch("currentStep",function(e){if(e){var t=i.selectedStep.wzTitle;i.selectedStep&&t!==i.currentStep&&i.goTo(u(i.currentStep))}}),i.$watch("[editMode, steps.length]",function(){var e=i.editMode;if(!angular.isUndefined(e)&&null!==e)if(e)angular.forEach(i.getEnabledSteps(),function(e){e.completed=!0});else{var n=i.currentStepNumber()-1;angular.forEach(i.getEnabledSteps(),function(e,t){n<=t&&(e.completed=!1)})}},!0),this.addStep=function(e){i.steps.push(e),1===i.getEnabledSteps().length&&i.goTo(i.getEnabledSteps()[0])},this.context=i.context,i.getStepNumber=function(e){return c(e)+1},i.goTo=function(t){var e;l?(r(),i.selectedStep=t,angular.isUndefined(i.currentStep)||(i.currentStep=t.wzTitle),t.selected=!0,i.$emit("wizard:stepChanged",{step:t,index:c(t)}),l=!1):(0<i.currentStepNumber()?e=i.currentStepNumber()-1:0===i.currentStepNumber()&&(e=0),a.all([function(e,t){var n,r;return void 0===e.canexit||i.getStepNumber(t)<i.currentStepNumber()||("boolean"==typeof e.canexit?e.canexit:(r=e.canexit(i.context),angular.isFunction(r.then)?(n=a.defer(),r.then(function(e){n.resolve(e)}),n.promise):!0===r))}(i.getEnabledSteps()[e],t),function(e){var t,n;return void 0===e.canenter||("boolean"==typeof e.canenter?e.canenter:(n=e.canenter(i.context),angular.isFunction(n.then)?(t=a.defer(),n.then(function(e){t.resolve(e)}),t.promise):!0===n))}(t)]).then(function(e){e[0]&&e[1]&&(r(),i.selectedStep=t,angular.isUndefined(i.currentStep)||(i.currentStep=t.wzTitle),t.selected=!0,i.$emit("wizard:stepChanged",{step:t,index:c(t)}))}))},i.currentStepNumber=function(){return c(i.selectedStep)+1},i.getEnabledSteps=function(){return i.steps.filter(function(e){return"true"!==e.disabled})},this.currentStepTitle=function(){return i.selectedStep.wzTitle},this.currentStepDescription=function(){return i.selectedStep.description},this.currentStep=function(){return i.selectedStep},this.totalStepCount=function(){return i.getEnabledSteps().length},this.getEnabledSteps=function(){return i.getEnabledSteps()},this.currentStepNumber=function(){return i.currentStepNumber()},this.next=function(e){var t=i.getEnabledSteps(),n=c(i.selectedStep);if(angular.isFunction(e)){if(!e())return;n===t.length-1?this.finish():i.goTo(t[n+1])}e||(i.selectedStep.completed=!0),n===t.length-1?this.finish():i.goTo(t[n+1])},this.goTo=function(e){var t,n=i.getEnabledSteps();t=angular.isNumber(e)?n[e]:u(e),i.goTo(t)},this.finish=function(){i.onFinish&&i.onFinish()},this.previous=function(){var e=c(i.selectedStep);if(0===e)throw new Error("Can't go back. It's already in step 0");i.goTo(i.getEnabledSteps()[e-1])},this.cancel=function(){if(0===c(i.selectedStep))throw new Error("Can't go back. It's already in step 0");i.goTo(i.getEnabledSteps()[0])},this.reset=function(){angular.forEach(i.getEnabledSteps(),function(e){e.completed=!1}),this.goTo(0)}}]}}),wizardButtonDirective("wzNext"),wizardButtonDirective("wzPrevious"),wizardButtonDirective("wzFinish"),wizardButtonDirective("wzCancel"),wizardButtonDirective("wzReset"),angular.module("mgo-angular-wizard").factory("WizardHandler",function(){var n={},r={};return n.defaultName="defaultWizard",n.addWizard=function(e,t){r[e]=t},n.removeWizard=function(e){delete r[e]},n.wizard=function(e){var t=e;return e||(t=n.defaultName),r[t]},n});